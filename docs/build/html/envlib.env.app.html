<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>envlib.env.app module &mdash; env_setup_v2 v0.0.2 文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="envlib.env.config module" href="envlib.env.config.html" />
    <link rel="prev" title="envlib.env package" href="envlib.env.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> env_setup_v2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#id1">1. 项目简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#id5">2. 主要库</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#id10">3. 提交说明</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">envlib</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="envlib.html">envlib package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="envlib.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="envlib.env.html">envlib.env package</a></li>
<li class="toctree-l4"><a class="reference internal" href="envlib.env_resources.html">envlib.env_resources package</a></li>
<li class="toctree-l4"><a class="reference internal" href="envlib.envsetup.html">envlib.envsetup package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="envlib.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="envlib.html#module-envlib">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">env_setup_v2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">envlib</a> &raquo;</li>
          <li><a href="envlib.html">envlib package</a> &raquo;</li>
          <li><a href="envlib.env.html">envlib.env package</a> &raquo;</li>
      <li>envlib.env.app module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/envlib.env.app.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-envlib.env.app">
<span id="envlib-env-app-module"></span><h1>envlib.env.app module<a class="headerlink" href="#module-envlib.env.app" title="永久链接至标题"></a></h1>
<section id="envlib-app">
<h2>envlib.app<a class="headerlink" href="#envlib-app" title="永久链接至标题"></a></h2>
<p>实用应用程序集合</p>
<dl class="py function">
<dt class="sig sig-object py" id="envlib.env.app._assure_keys_in_request_parameters">
<span class="sig-prename descclassname"><span class="pre">envlib.env.app.</span></span><span class="sig-name descname"><span class="pre">_assure_keys_in_request_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key_set</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#_assure_keys_in_request_parameters"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app._assure_keys_in_request_parameters" title="永久链接至目标"></a></dt>
<dd><p>检查传入的key_set是允许的options</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><p><strong>key_set</strong> – set: 请求参数集合</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>允许的options有:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;cookies&#39;</span><span class="p">,</span> <span class="s1">&#39;files&#39;</span><span class="p">,</span> <span class="s1">&#39;auth&#39;</span><span class="p">,</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span>
<span class="s1">&#39;allow_redirects&#39;</span><span class="p">,</span> <span class="s1">&#39;proxies&#39;</span><span class="p">,</span> <span class="s1">&#39;hooks&#39;</span><span class="p">,</span> <span class="s1">&#39;stream&#39;</span><span class="p">,</span> <span class="s1">&#39;verify&#39;</span><span class="p">,</span> <span class="s1">&#39;cert&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">返回</dt>
<dd class="field-odd"><p>Bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="envlib.env.app.Env">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">envlib.env.app.</span></span><span class="sig-name descname"><span class="pre">Env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env" title="永久链接至目标"></a></dt>
<dd><p>基类：<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>运行环境类，只有用户+端口不同的才创建新的实例</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env._instance_lock">
<span class="sig-name descname"><span class="pre">_instance_lock</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;unlocked</span> <span class="pre">_thread.lock</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#envlib.env.app.Env._instance_lock" title="永久链接至目标"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#envlib.env.app.Env.debug" title="永久链接至目标"></a></dt>
<dd><p>The debug flag.  Set this to <cite>True</cite> to enable debugging of the
application.  In debug mode the debugger will kick in when an unhandled
exception ocurrs and the integrated server will automatically reload
the application if changes in the code are detected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.__init__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.__init__" title="永久链接至目标"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.port">
<span class="sig-name descname"><span class="pre">port</span></span><a class="headerlink" href="#envlib.env.app.Env.port" title="永久链接至目标"></a></dt>
<dd><p>平台port, 如’8000’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.user">
<span class="sig-name descname"><span class="pre">user</span></span><a class="headerlink" href="#envlib.env.app.Env.user" title="永久链接至目标"></a></dt>
<dd><p>登陆用户</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.password">
<span class="sig-name descname"><span class="pre">password</span></span><a class="headerlink" href="#envlib.env.app.Env.password" title="永久链接至目标"></a></dt>
<dd><p>登陆密码</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.rest">
<span class="sig-name descname"><span class="pre">rest</span></span><a class="headerlink" href="#envlib.env.app.Env.rest" title="永久链接至目标"></a></dt>
<dd><p>当前的Rest实例</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.ssh">
<span class="sig-name descname"><span class="pre">ssh</span></span><a class="headerlink" href="#envlib.env.app.Env.ssh" title="永久链接至目标"></a></dt>
<dd><p>初始化SSH连接为集群的业务虚ip</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.pgsql">
<span class="sig-name descname"><span class="pre">pgsql</span></span><a class="headerlink" href="#envlib.env.app.Env.pgsql" title="永久链接至目标"></a></dt>
<dd><p>初始化pgsql连接</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.vertica">
<span class="sig-name descname"><span class="pre">vertica</span></span><a class="headerlink" href="#envlib.env.app.Env.vertica" title="永久链接至目标"></a></dt>
<dd><p>初始化pgsql连接</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.smb">
<span class="sig-name descname"><span class="pre">smb</span></span><a class="headerlink" href="#envlib.env.app.Env.smb" title="永久链接至目标"></a></dt>
<dd><p>初始化smb client连接</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#envlib.env.app.Env.config" title="永久链接至目标"></a></dt>
<dd><p>预留config设置模式选项</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.extensions">
<span class="sig-name descname"><span class="pre">extensions</span></span><a class="headerlink" href="#envlib.env.app.Env.extensions" title="永久链接至目标"></a></dt>
<dd><p>预留扩展模块</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="envlib.env.app.Env.current_context">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">current_context</span></span><a class="headerlink" href="#envlib.env.app.Env.current_context" title="永久链接至目标"></a></dt>
<dd><p>返回当前环境上下文实例</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env._get_restful_response">
<span class="sig-name descname"><span class="pre">_get_restful_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env._get_restful_response"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env._get_restful_response" title="永久链接至目标"></a></dt>
<dd><p>对restful接口的返回值，做状态判断，并尝试以json形式返回</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>新接口有标准的接口规范，response示例 {“error_code”:”0000000000”, “message”:”XXX处理成功”, “data”: {业务自定义json格式}}
使用老接口时有warning信息, 新接口将自动提取data</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><p><strong>**options</strong> – 可选’method’, ‘url’, ‘params’, ‘data’, ‘headers’, ‘cookies’, ‘files’, ‘auth’, ‘timeout’,
‘allow_redirects’, ‘proxies’, ‘hooks’, ‘stream’, ‘verify’, ‘cert’, ‘json’</p>
</dd>
<dt class="field-even">关键字参数</dt>
<dd class="field-even"><p><strong>check</strong> – 是否强制断言接口返回值为[200, 201, 204]状态之一，默认开启，强制校验接口返回若非2XX状态，程序会有中断</p>
</dd>
<dt class="field-odd">返回</dt>
<dd class="field-odd"><p>content or data json, 接口返回
新接口将自动提取data json片断</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.send_by_rest">
<span class="sig-name descname"><span class="pre">send_by_rest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.send_by_rest"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.send_by_rest" title="永久链接至目标"></a></dt>
<dd><p>rest请求封装</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – url, <a class="reference external" href="mailto:'api&#37;&#52;&#48;options">‘api<span>&#64;</span>options</a>’形式, 如’<a class="reference external" href="mailto:/api/demo&#37;&#52;&#48;get">/api/demo<span>&#64;</span>get</a>’</p></li>
<li><p><strong>**kwargs</strong> – 可选’method’, ‘url’, ‘params’, ‘data’, ‘headers’, ‘cookies’, ‘files’, ‘auth’, ‘timeout’,
‘allow_redirects’, ‘proxies’, ‘hooks’, ‘stream’, ‘verify’, ‘cert’, ‘json’</p></li>
</ul>
</dd>
<dt class="field-even">关键字参数</dt>
<dd class="field-even"><p><strong>check</strong> – 是否强制断言接口返回值为[200, 201, 204]状态之一，默认开启，强制校验接口返回若非2XX状态，程序会有中断</p>
</dd>
<dt class="field-odd">返回</dt>
<dd class="field-odd"><p>接口返回内容content的data，兼容新老接口，新接口将自动提取 <em>data</em> ，老接口会有warning提示，返回原 <em>content</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.bind_to_g">
<span class="sig-name descname"><span class="pre">bind_to_g</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.bind_to_g"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.bind_to_g" title="永久链接至目标"></a></dt>
<dd><p>绑定单个value到环境变量，以key,value的形式绑定到当前运行的Env实例关联的上下文环境信息AppCtxGlobals实例的代理 <code class="docutils literal notranslate"><span class="pre">g</span></code></p>
<p>适用于循环/批量处理值的绑定</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – key</p></li>
<li><p><strong>value</strong> – 待绑定的value</p></li>
<li><p><strong>lock</strong> – 是否加锁，加锁且值存在，将不修改原值</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.smb_upload_excel">
<span class="sig-name descname"><span class="pre">smb_upload_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_relative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'application/vnd.ms-excel'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.smb_upload_excel"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.smb_upload_excel" title="永久链接至目标"></a></dt>
<dd><p>SMB连接上传excel</p>
<p>smb远程读文件转化为multipart/form-data请求所需的data 和 header</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – 文件名</p></li>
<li><p><strong>file_relative_path</strong> (<em>str</em>) – 相对远程目录，根目录为env.ini文件中的smb_share <code class="docutils literal notranslate"><span class="pre">\\1.1.1.1\info\auto\</span></code></p></li>
<li><p><strong>file_type</strong> (<em>str</em>) – <p>文件类型，默认为excel类型，’application/vnd.ms-excel’
可能用到的例如，具体可抓包查找</p>
<p>’doc[x]’   :  ‘application/msword’</p>
<p>’xls[x]’   :  ‘application/vnd.ms-excel’</p>
<p>’zip’      :  ‘application/zip’</p>
<p>’jpeg|jpg’:  ‘image/jpeg’</p>
<p>’png’      :  ‘image/png’</p>
</p></li>
<li><p><strong>**kwargs</strong> – <p>可选参数，以字典形式传入
用来表示除了’file’: file_tuple，以外的其他参数</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MultipartEncoder</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">file_tuple</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>data, headers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.smb_upload_zip">
<span class="sig-name descname"><span class="pre">smb_upload_zip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_relative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'application/x-zip-compressed'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.smb_upload_zip"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.smb_upload_zip" title="永久链接至目标"></a></dt>
<dd><p>SMB连接上传zip文件，需要额外传入tab_id=tab_id</p>
<p>smb远程读文件转化为multipart/form-data请求所需的data 和 header</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – 文件名</p></li>
<li><p><strong>file_relative_path</strong> (<em>str</em>) – 相对远程目录，根目录为env.ini文件中的smb_share <code class="docutils literal notranslate"><span class="pre">\\1.1.1.1\info\auto\</span></code></p></li>
<li><p><strong>file_type</strong> (<em>str</em>) – <p>文件类型，默认为excel类型，’application/vnd.ms-excel’
可能用到的例如，具体可抓包查找</p>
<p>’doc[x]’   :  ‘application/msword’</p>
<p>’xls[x]’   :  ‘application/vnd.ms-excel’</p>
<p>’zip’      :  ‘application/zip’</p>
<p>’jpeg|jpg’:  ‘image/jpeg’</p>
<p>’png’      :  ‘image/png’</p>
</p></li>
<li><p><strong>**kwargs</strong> – <p>可选参数，以字典形式传入, ‘tab_id’: tab_id
用来表示除了’file’: file_tuple，以外的其他参数</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MultipartEncoder</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">file_tuple</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>data, headers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.smb_upload_jpg">
<span class="sig-name descname"><span class="pre">smb_upload_jpg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_relative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image/jpeg'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.smb_upload_jpg"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.smb_upload_jpg" title="永久链接至目标"></a></dt>
<dd><p>SMB连接上传jpg,jpeg文件</p>
<p>smb远程读文件转化为multipart/form-data请求所需的data 和 header</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – 文件名</p></li>
<li><p><strong>file_relative_path</strong> (<em>str</em>) – 相对远程目录，根目录为env.ini文件中的smb_share <code class="docutils literal notranslate"><span class="pre">\\1.1.1.1\info\auto\</span></code></p></li>
<li><p><strong>file_type</strong> (<em>str</em>) – <p>文件类型，默认为excel类型，’application/vnd.ms-excel’
可能用到的例如，具体可抓包查找</p>
<p>’doc[x]’   :  ‘application/msword’</p>
<p>’xls[x]’   :  ‘application/vnd.ms-excel’</p>
<p>’zip’      :  ‘application/zip’</p>
<p>’jpeg|jpg’:  ‘image/jpeg’</p>
<p>’png’      :  ‘image/png’</p>
</p></li>
<li><p><strong>**kwargs</strong> – <p>可选参数，以字典形式传入
用来表示除了’file’: file_tuple，以外的其他参数</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MultipartEncoder</span><span class="p">(</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="n">file_tuple</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>data, headers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.smb_get_base64">
<span class="sig-name descname"><span class="pre">smb_get_base64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_relative_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.smb_get_base64"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.smb_get_base64" title="永久链接至目标"></a></dt>
<dd><p>SMB读取远端图片数据路径，并返回base64</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>str</em>) – 文件名</p></li>
<li><p><strong>file_relative_path</strong> (<em>str</em>) – 相对远程目录，根目录为env.ini文件中的smb_share <code class="docutils literal notranslate"><span class="pre">\\1.1.1.1\info\auto\</span></code></p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>(str) base64编码</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env._rest_login">
<span class="sig-name descname"><span class="pre">_rest_login</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env._rest_login"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env._rest_login" title="永久链接至目标"></a></dt>
<dd><p>会话登录, 保存session, cookies</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rest</strong> (<em>str</em>) – 需要登录的会话</p></li>
<li><p><strong>begin_url</strong> (<em>str</em>) – 登录初始url</p></li>
<li><p><strong>username</strong> (<em>str</em>) – 登录用户名</p></li>
<li><p><strong>password</strong> (<em>str</em>) – 登录密码</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env._re_login">
<span class="sig-name descname"><span class="pre">_re_login</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env._re_login"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env._re_login" title="永久链接至目标"></a></dt>
<dd><p>重新登陆rest会话</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env._fetch_appropriate_rest">
<span class="sig-name descname"><span class="pre">_fetch_appropriate_rest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env._fetch_appropriate_rest"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env._fetch_appropriate_rest" title="永久链接至目标"></a></dt>
<dd><p>从单例Rest实例池获取缓存的实例，否则新建</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env._headers">
<span class="sig-name descname"><span class="pre">_headers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env._headers"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env._headers" title="永久链接至目标"></a></dt>
<dd><p>登录后的的header</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.push_context">
<span class="sig-name descname"><span class="pre">push_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.push_context"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.push_context" title="永久链接至目标"></a></dt>
<dd><p>调用方式触发上下文</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.pop_context">
<span class="sig-name descname"><span class="pre">pop_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.pop_context"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.pop_context" title="永久链接至目标"></a></dt>
<dd><p>调用方式弹出上下文</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.__enter__">
<span class="sig-name descname"><span class="pre">__enter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.__enter__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.__enter__" title="永久链接至目标"></a></dt>
<dd><p>with方式触发上下文</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.__exit__">
<span class="sig-name descname"><span class="pre">__exit__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc_tb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.__exit__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.__exit__" title="永久链接至目标"></a></dt>
<dd><p>自动释放上下文</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="envlib.env.app.Env.__new__">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__new__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/envlib/env/app.html#Env.__new__"><span class="viewcode-link"><span class="pre">[源代码]</span></span></a><a class="headerlink" href="#envlib.env.app.Env.__new__" title="永久链接至目标"></a></dt>
<dd><p>基于元类的实例产生</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'envlib.env.app'</span></em><a class="headerlink" href="#envlib.env.app.Env.__module__" title="永久链接至目标"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="envlib.env.app.Env.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#envlib.env.app.Env.__weakref__" title="永久链接至目标"></a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="envlib.env.html" class="btn btn-neutral float-left" title="envlib.env package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="envlib.env.config.html" class="btn btn-neutral float-right" title="envlib.env.config module" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2021, sean.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>